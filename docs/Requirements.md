### **요구사항 분석**

**1. 유저 토큰 발급 API**
- 사용자가 서비스를 이용하려면 토큰을 발급받아야 하며, 이를 통해 사용자의 대기 상태나 잔여 시간을 관리할 수 있어야 합니다.
- 토큰에는 유저의 UUID와 해당 유저의 대기열 정보를 포함해야 합니다.
- 토큰 발급 후 이후 모든 API 호출에서 이 토큰을 사용하여 유저의 대기열 및 상태를 검증해야 합니다.
- 토큰은 일회성으로 발급될 수 있으며, 일정 시간이 지나면 만료될 수 있습니다.
- 모든 API는 유효한 토큰을 이용해 요청을 검증해야 하며, 토큰이 유효하지 않거나 만료되면 요청이 실패해야 합니다.
  
**2. 예약 가능 날짜 / 좌석 API**
- 예약 가능한 날짜와 좌석 정보를 제공해야 합니다.
- 각 날짜에 대한 예약 가능한 좌석의 수와 상태(예: 예약 가능, 예약 완료 등)를 반환해야 합니다.
- 동시성 문제: 다수의 사용자가 동시에 좌석을 예약할 때, 좌석 예약 상태를 실시간으로 관리해야 합니다. 따라서, 상태 변경 시 적절한 동시성 제어가 필요합니다.
- 좌석 상태가 실시간으로 반영되며, 다른 유저가 이미 예약된 좌석을 선택할 수 없도록 해야 합니다.
  
**3. 좌석 예약 요청 API**
- 사용자는 잔액을 이용해 좌석을 예약하며, 예약 후 결제 전이라도 일정 시간 동안 다른 사용자가 해당 좌석을 예약할 수 없도록 해야 합니다.
- 예약 요청 시, 대기열 시스템을 통해 대기 상태가 반영되어야 하며, 다른 사용자가 해당 좌석을 선택할 수 없는 상태로 변경해야 합니다.
- 좌석 예약 요청은 유저가 대기열을 통과해야 하므로, 토큰을 발급받은 유저만 요청할 수 있어야 합니다.
- 동시성 문제: 여러 사용자가 동시에 같은 좌석을 예약하려 할 수 있으므로, 서버 측에서 대기열을 관리하고, 결제 이전에 해당 좌석을 예약한 유저만 접근할 수 있도록 해야 합니다.
- 일정 시간이 지나면 예약이 취소되거나 대기열에서 제외될 수 있습니다.
  
**4. 잔액 충전 / 조회 API**
- 사용자는 잔액을 충전할 수 있으며, 충전된 잔액은 예약에 사용됩니다.
- 사용자는 언제든지 자신의 잔액을 조회할 수 있어야 하며, 이를 기반으로 예약을 할 수 있습니다.
- 동시성 문제: 여러 사용자가 동시에 잔액을 조회하거나 충전할 수 있으므로, 잔액 처리는 원자적이어야 하며, 충전 작업 중에도 다른 사용자 요청을 정상 처리할 수 있도록 해야 합니다.
- 잔액이 부족하면 예약이 불가능하므로, 이 부분에 대한 유효성 검사 및 오류 처리 필요.
  
**5. 결제 API**
- 좌석 예약 후, 결제를 통해 실제 좌석 예약을 확정지어야 합니다.
- 결제 시, 사용자의 잔액을 차감해야 하며, 결제 처리 후 결제 완료 상태를 업데이트해야 합니다.
- 동시성 문제: 여러 사용자가 동시에 결제를 시도할 수 있으므로, 결제 처리 시 중복 결제나 잘못된 결제가 발생하지 않도록 해야 합니다.
- 결제 전에 잔액 확인을 반드시 해야 하며, 잔액이 부족하면 결제가 실패해야 합니다.
